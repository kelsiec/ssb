{% extends "site_base.html" %}

{% block content %}
  <div class="container">
    <h2>Poses</h2>
    <section class="section">
      <div class="container">
          <div id="pose-table-container" class="columns"><!-- React --></div>
      </div>
    </section>
    <br><br>
    <h2>Flows</h2>
    <table id="flow-table" class="table table-striped table-bordered" cellspacing="0">
      <thead>
        <tr>
          <th>Name</th>
          <th>Poses</th>
          <th>Benefits</th>
          <th>Required Prep</th>
          <th>Required Comp</th>
          <th>Actions</th>
        </tr>
      </thead>
        <tbody>
          {% for flow in flows %}
            <tr id={{flow.id}}>
              <td nowrap>{{ flow.name }}</td>
              <td nowrap>{{ flow.poses_to_string|safe }}</td>
              <td nowrap>{{ flow.benefits_to_string|safe }}</td>
              <td nowrap>{{ flow.preparation_to_string|safe }}</td>
              <td nowrap>{{ flow.compensation_to_string|safe }}</td>
              <td>
                <center>
                <a href="#" onclick="javascript:removeFlows({{flow.id}})" data-toggle="tooltip" title="Delete">
                  <span><i class="glyphicon glyphicon-remove"></i></span>
                </a>
                <a href="{% url 'edit_flow' flow.id %}" target="blank" data-toggle="tooltip" title="Edit">
                  <span><i class="glyphicon glyphicon-pencil"></i></span>
                </a>
              </center>
              </td>
            </tr>
          {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}

{% block extra_js %}
  <script>
    function removeFlows(flow_id){
      $.ajax('{% url "delete_flow" %}', {
        type: "POST",
        method: "POST",
        data: {'flow_ids': [flow_id] },
        dataType: "json",
        success: function() {
          $("tr").filter(function() {
              return this.id == flow_id;
          })[0].style.display = 'none';
        },
      });
    }
  </script>
{% endblock %}